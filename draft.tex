\documentclass[11 pt , letterpaper , twoside , openright]{book}
\usepackage[utf8]{inputenc}

\usepackage[english]{babel}     	
\usepackage{graphicx}                   % om afbeeldingen in te kunnen laden   
\usepackage{tikz,tikz-3dplot}                       % om afbeeldingen te kunnen maken
\usetikzlibrary{calc}                   % meer opties in tikz (oa coordinaten bepalen)

\usepackage{wrapfig}              % meer controle over figuren
\usepackage{floatrow}
\usepackage[format=hang]{caption}
\usepackage{listings}                   % voor mooie code
\usepackage{amsmath, amssymb, amsfonts} % om wiskunde te typen
\usepackage{scalerel}                   % om symbolen te schalen
\let\proof\relax
\let\endproof\relax
\usepackage{amsthm}
\usepackage{bm}                         % Wiskundesymbolen vet met commando \bm{}
\usepackage{libertine}                  % lettertype
\usepackage{inconsolata}                % lettertype code
\usepackage[T1]{fontenc}                % betere lettertype encodering voor talen met accenten
\usepackage{setspace}
\usepackage{enumitem}
\usepackage{units}
\usepackage{multicol}
\usepackage{appendix}
\usepackage{titlesec}
\usepackage{algorithm}
\usepackage{physics}
\usepackage{interval}
\usepackage[colorlinks,citecolor=red,urlcolor=blue,bookmarks=false,hypertexnames=true]{hyperref} 
\usepackage[noend]{algpseudocode}
\usepackage{tikz-feynman}
\usepackage{subcaption}
\usepackage{xfrac}
\tikzfeynmanset{compat=1.1.0}
\floatname{algorithm}{Algoritme}

\begin{document}
\frontmatter
\tableofcontents
%\listoffigures

\mainmatter
\chapter{Introduction}

% add research question and hypotheses!!
% also talk about algorithmic personalisation!!

The past decade social media has become ever more important in our daily lives. Nowadays most of us have, beside a real world life, a virtual life on social media. This increased engagement on social media may have a huge impact on the formation of opinions, not only on the individual scale, but also on a broader, societal scale. It is known that individuals not only form their opinions through self-reflection, but also through interactions with other people and with their surroundings \cite{Perra2019}. The broad range of interactions people undergo on social media with people from all over the world can thus not be underestimated in the process of opinion formation. The understanding of the role of social media on the emergence of polarization and extremism in society is of uttermost importance.\\
\newline
One important feature of opinion dynamics on social media is the use of algorithmic personalization. Social media allow for simultaneous or asynchronous interactions between people without geographical constraints and thus allow for the spread of information at a faster pace and at an unprecedented scale \cite{Perra2019}. People are, however, still bound by temporal and cognitive constraints. In order to assure a more pleasant/convenient experience on their platforms, social media companies use algorithms to order/filter the posts on an individuals time line according to what might be relevant to that individual \cite{Perra2019}. It is thus important to know the possible effects of these filtering algorithms on the evolution of opinions in the population.\\  
\newline
It is also known that some people change their opinions more easily than others, that is, once in a while you encounter somebody that is really stubborn and persistent towards its own opinion. One of the aims of this thesis is to design toy models of opinion dynamics with stubborn actors on theoretical and real-world social networks to analyze the interplay between individual resistance to change and the network structure in the evolution of two competing opinions.\\
\newline
Opinion dynamics models have two important layers. On one hand, we introduce social networks to describe the underlying structure of social interactions, while on the other hand we need appropriate opinion dynamics/formation models to reproduce the opinion dynamics and opinion formation processes found in real life.
% refer to relevant sections in introduction?


\section{Complex networks}

Complex networks have become more and more popular for analyzing complex, dynamical systems. They are used in fields such as physics, economics, social sciences, biology, etc \cite{Costa2008}. These different fields are very diverge, but they have at least one common ground: they often deal with a large number of variables/components that interact with each other. In other words, in all these fields one encounters complex systems, systems where it is not possible to predict collective behavior based on the properties of the individual components alone \cite{Mata2020}. Complex systems often display phenomena such as non-linearity, emergence, spontaneous order,... %(maybe check cursus compl en crit?)
\\
\newline
One of the tools to deal with these complex systems and to give us more insight in the possible underlying structures are complex networks. A network, also often called a graph, is a structure composed of nodes or vertices and a set of links or edges that indicate the interactions between the nodes \cite{Mata2020}. Representing/modeling a complex system as a graph makes the system appear more simple and tractable, while it still includes the non-linearity of these systems. One can find the language to describe networks in mathematical graph theory. However, complex systems in real life situations often deal with a huge number of components, so the use of statistical and high-performance computing tools is inevitable \cite{Mata2020}. One could argue that the study of complex networks lies somewhere at the intersection of mathematical graph theory and statistical physics \cite{F.Costa2007}.\\
The advantage of working with network models is that they reduce the level of complexity encountered in the real world, so that one can treat these systems in a more practical way. However, we do want our models to display properties similar to the ones seen in real systems \cite{Mata2020}. Since many real systems are not static but evolve in time, this means that we don't only need to deal with static networks but also with temporal networks. Temporal networks are networks where the edges are not always active, but instead become active for some periods of time \cite{Holme2012}. In temporal networks time becomes an explicit element in the network representation \cite{Holme2012}. Static networks have been widely studied and are often convenient for their analytic tractability, whereas temporal networks are, in some cases, more realistic \cite{Mata2020}.\\
Some other important concepts in network theory are the degree distribution, clustering/community structure, connectivity, etc. These concepts will be explained in depth in Chapter \ref{chap2}, Section \ref{netDef}, but let us already anticipate a bit on the case of social networks. It is found that many real-life social systems have a power law degree distribution \cite{Muchnik2013}. This heterogeneous or scale free degree distribution represents one of the three general properties of social networks. The other two are short distances and high clustering, these two are also referred to as "small world phenomenon" (note that in the literature the term "small world" sometimes only refers to the property of short distances, however, in this thesis, we will use it to indicate both a high clustering and short distances) \cite{Muchnik2013}. Ideally, our theoretical network should exhibit these three properties. Some theoretical networks, that are thoroughly studied, do not possess all of these three properties. However, they might still be used, because of their simplicity and ability to produce analytic results. When using these models one must always bear in mind their limitations to reproduce some properties encountered in real social systems. \\
\newline
One of the goals of this thesis is to investigate/determine the role of the underlying network structure on the formation and dynamics of opinions in the system. Some examples of theoretical network models used in this thesis are the Erd\H{o}s-R\'{e}nyi network, the stochastic block model, the Watts-Strogatz model, etc. These will be explained thoroughly in Chapter \ref{chap2}, Section \ref{netModel}. %references to chapter 2 need to be adapted
% to do: read links 19, 21, 22, 23, 24 of https://arxiv.org/pdf/0711.3199.pdf

% maybe also talk about degree distributions (poisson, power law), power law behavior of many real systems, clustering + maybe talk about networks that will be used in this thesis?

% talk about difference between simple networks and complex network??

\section{Opinion dynamics}

As stated before, the formation of an individual's opinion is the result of the interplay of many factors such as self-reflection, peer pressure, the individual's personality (eg. stubbornness), the information someone is exposed to, etc.  Opinion dynamics models should try to capture these complex processes in a simplified way. Several models have been developed ranging from simple binary models to more complex, continuous approaches \cite{Sirbu2016}.\\
The basic idea of all opinion dynamic models is that the nodes or agents in a social network have a variable that represents their opinion and that is updated according to some predefined rules. These models are obviously a simplification of real world opinion dynamics. It is however shown that they do display a lot of aspects of real opinion formation such as agreement, transitions between order (consensus) and disorder (fragmentation), polarization, formation of echo chambers (clusters of people with the same opinion), etc \cite{Sirbu2016}. \\
\newline
The opinion of the agents in the model can be either discrete or continuous. This thesis deals with models where each agent can have one of the two opinions A or B and thus only deals with the case of discrete opinions. This might come across as a huge simplification of the real world complexity of opinion formation, but also in real life people often have to choose between two competing opinions (eg. republicans or democrats, cat or dog, renting or buying a house,...). \\
\newline
The rules that determine how an agent updates his or her opinion can include many different aspects. They can, for example, be as simple as a majority rule (i.e. the majority model: if the majority of your neighbors have a certain opinion, you adopt that opinion as well) or can include a more probabilistic way of updating. A small overview of possible opinion dynamics models is given in Chapter \ref{chap3}, Section \ref{Bin} and Section \ref{Con}. \\
One can also include a resistance parameter that determines the hesitation of an agent to change to a new opinion and/or a parameter that determines the influence of an agent on others. Furthermore, the agents can have a parameter that determines whether they are active or not. The introduction of stubborn people will be discussed in Chapter \ref{chap3}, Section \ref{stubb}; the activation mechanism of nodes is discussed in Chapter \ref{chap3}, Section \ref{actMech}.\\
\newline
Since this thesis deals with the particular case of opinion dynamics on on-line social platforms, it is important to define/set up different filtering algorithms. The filtering algorithms that real social media companies use, are corporate secrets, but we know that there are three main principles of content curation: popularity, semantic and collaborative filtering \cite{Perra2019}. Here popularity filtering refers to the practice of promoting content that is popular across the platform; semantic filtering means that post similar to previous consumed posts are recommended and collaborative filtering suggests posts that are similar to the ones our friends consume \cite{Perra2019}. In Chapter \ref{chap3}, Section \ref{filter} a detailed description of the filtering algorithms used in  this thesis will be given.
% add reference to chapter 2
%The rules that determine how an agent updates his or her opinion can include many different aspect, such as the higher or lower influence somebody can have on others, the resistance to change to a new opinion, peer pressure,... The structure of social networks plays an important role in aspects as peer pressure, whereas the algorithmic personalization used on social media platforms may interfere with the information someone is exposed to. Algorithmic personalization is the individualized way in which social media platforms show posts/information to each of its users.

% not finished, describe different models
% talk about updating rules used in thesis + concepts as resistance etc. 
% biblio: https://link.springer.com/article/10.1007/s13538-020-00772-9

\section{Statistical and social physics}

Another important tool in the study of opinion dynamics/formations in large groups of people is the use of statistical physics. This branch of physics offers a framework that relates microscopic properties of atoms, molecules,... to macroscopic observed behavior and has a wide field of applications inside and outside the world of physics.\\
The observation that large number of people display collective, `macroscopic' behavior begged for the use of the concepts and insights developed in statistical physics \cite{Sirbu2016}. The application of the theory of statistical physics on social phenomena is referred to as social physics or sociophysics. The `microscopic' constituents are now individual humans who interact with a limited number of other individuals and in that way form complex, `macroscopic' groups such as human societies. These `macroscopic' groups display stunning regularities, transitions from disorder to order, the emergence of consensus, universality, etc \cite{Buchanan2007}. The statistical physics approach of these social systems tries to explain the found regularities at large scale as collective effects of the interactions among these individuals \cite{Sirbu2016}.\\
\newline
The statistical approach of social phenomena has one big difficulty compared to the description of gases and other physical phenomena. In regular physics, the microscopic constituents are `simple' atoms or molecules, whose dynamics and interactions with each other are often well known and can be put in relatively simple laws with only a few parameters \cite{Castellano2009}. Humans, on the other hand, are far from simple entities and the dynamics of a single individual are far from known \cite{Castellano2009}. Even if the dynamics/behavior of individuals would be well know, then the interactions between them would still be complicated and it would be impossible to describe them with simple laws and only a few parameters \cite{Castellano2009}. Hence, it may seem that extracting useful and qualitative information out of social models is a nearly impossible and almost hopeless task \cite{Castellano2009}. \\
However, the use of statistical physics may also offer a way out. In most situations the qualitative (and sometimes even quantitative) properties of large scale phenomena do not depend on the microscopic details of the process \cite{Castellano2009}. Instead, the relevant aspects for the global behavior are often higher level features such as symmetries, conservation laws, dimensionality, etc \cite{Castellano2009}. This introduces a concept of universality. With this universality in mind, one can proceed to build models of human/social behavior where only the simplest and most important properties of single individuals and their interactions are taken into account \cite{Castellano2009}. An important factor herein is the comparison with real/empirical data to investigate whether or not the trends seen in real life are compatible with the outputs generated by the models \cite{Castellano2009}. Note that this is not only an important factor in social physics, but also in regular physical research and science in general.
% talk about history


% talk somewhere about rise of social physics, the need to use statistical physics (because of macroscopic phenomena as scale invariance, emergence, polarization,...)

\section{This thesis: hypotheses and goals}

As said before, this thesis will try to investigate the interplay between the social network structure and the individual resistance to change in the evolution of two competing opinions. So on one hand, we want to determine the influence of different network structures on the formation and evolution of opinions, whereas, on the other hand, we would like to investigate the effect of stubborn agents in the network. Since this thesis deals with opinion dynamics on social media, the effect of filtering algorithms must also be included.\\ 
\newline
In one of their previous papers (see reference \cite{Perra2019}) prof. Nicola Perra and prof. Luis E.C. Rocha investigated both the effect of different filtering algorithms and different network topologies on the formation and evolution of two competing opinions. They also considered the effect of nudging (meaning that one opinion is pushed to all agents in the network).\\ Their main findings were that the algorithmic filtering could not break the status quo when the prevalence of opinions was equally distributed in the population and that topological correlations (such as high clustering coefficient) could result in the formation of echo chambers \cite{Perra2019}. On the other hand, a more heterogeneous contact pattern could hamper this formation of echo chambers \cite{Perra2019}. If the two opinions were, initially, not equally distributed, one of the filtering algorithms (namely semantic filtering) caused a further increase in the predominant opinion \cite{Perra2019}. In the case of nudging, they found that the population opinion moved to the nudged opinion relatively fast, even in the case of small nudging.\\
They, however, did not investigate the effect of stubborn agents in the network, nor did they investigate networks with a community structure. This thesis will build on their model and incorporate these new features. We will compare networks that have a community structure and relatively low clustering to networks without community structure, but with a high clustering coefficient (a detailed description of concepts like clustering coefficient and community structure will be given in Chapter \ref{chap2}, Section \ref{netDef}). We want to investigate whether networks with community structure are able to form echo chambers, such as one can observe in networks with a high clustering coefficient and, if so, if one can observe convergence to one opinion inside the communities. On the other hand, we want to determine the impact of stubborn agents on the formation and evolution of opinions in the network.

% talk about goals and hypotheses, what does this thesis wants to investigate, reference paper Rocha --> what did they do, their findings, how does this thesis build on that
% give reference to sections were community structure etc are explained!


\chapter{Networks}
\label{chap2}

%https://www.researchgate.net/publication/324312765_What_is_a_Complex_Network_CDT-2

%https://www.nature.com/articles/s42005-020-0359-6

\section{Definition and network measurements}
\label{netDef}

Networks or graphs are conceptually very simple and flexible objects that are made of a set of nodes/vertices $V$ and a set of edges/links $E$, where the elements of $E$ determine connections between elements of $V$ \cite{Costa2018}
\begin{equation}
	E \subseteq \{\{x, y\}| x, y \in V \}
\end{equation}
If self-loops are not allowed, we need the following condition on the elements of $E$
\begin{equation}
	E \subseteq \{\{x, y\}| x, y \in V \text{and\ } x \neq y \}
\end{equation}
A graph with no self-loops is a simple graph. The nodes $x$ and $y$ of an edge $\{x, y\}$ are called the endpoints of the edge. It is possible that nodes are not joined by any edge, such nodes are called isolated or disconnected. If two or more edges have the same pair of endpoints, the graph is called a multi-graph. This thesis is not concerned with multi-graphs, nor are self-loops allowed. Graphs in which the edges have an orientation are called directed graphs. If the edges have weights $w_{ij}$, one speaks of a weighted graph.\\
A graph can be represented in different ways. One of the most common ways is by use of the adjacency matrix.\\

\subsection{Adjacency matrix}

The adjacency matrix \textbf{A} is a $N \times N$ matrix (for a graph with $N$ nodes) where the elements indicate whether two nodes are connected by an edge or not \cite{Mata2020}
\begin{equation}
	A_{ij} = 
	\begin{cases}
		1 & \text{if nodes $i$ and $j$ are connected}\\
		0 & \text{otherwise}
	\end{cases}
\end{equation}
For a simple, undirected graph, the adjacency matrix is symmetric ($A_{ij} = A_{ji}$) with zeros on the diagonal ($A_{ii} = 0$). Directed graphs have asymmetric adjacency matrices. If we are dealing with weighted graphs, the elements of the adjacency matrix are the weights $w_{ij}$ of the edges
\begin{equation}
	A_{ij} = 
	\begin{cases}
		w_{ij} & \text{if nodes $i$ and $j$ are connected}\\
		0 & \text{otherwise}
	\end{cases}
\end{equation}
with, generally, $0 \leqslant w_{ij} \leqslant 1$ \cite{Mata2020}. \\
\subsection{Degree and degree distribution}

The adjacency matrix contains a lot of information such as the degree of a node. The degree $k_i$ of a node $i$ is the number of edges attached to the node $i$ or, in others words, $k_i$ represents the number of nearest neighbors of the node $i$. The degree can be obtained from the adjacency matrix in the following way \cite{Mata2020}
\begin{equation}
	k_i = \sum_{j=1}^N A_{ij}
\end{equation}
In the case of a directed graph one can differentiate between the number of incoming edges $k_i^{\text{in}}$ and the number of outgoing edges $k_i^{\text{out}}$ of the node $i$. These are called the in-degree and out-degree respectively and are defined as \cite{Mata2020}
\begin{equation}
	k_i^{\text{in}} = \sum_{j=1}^N A_{ji} \quad \text{and} \quad k_i^{\text{out}} = \sum_{j=1}^N A_{ij}
\end{equation}
The total degree of node $i$ is then $k_i = k_i^{\text{in}} + k_i^{\text{out}}$. For weighted graphs the degree is easily generalized to the weighted degree $s_i$, often called strength \cite{Ioannis2007}
\begin{equation}
	s_i = \sum_{j=1}^N w_{ij}
\end{equation}
From the degree of the nodes in the network one can construct the degree distribution. The degree distribution $P(k)$ represents the fraction of nodes with a degree $k$ or, in other words, the degree distribution gives the probability that a randomly selected node has a degree $k$. The average degree can be obtained from the degree distribution \cite{Mata2020}
\begin{equation}
	\left<k\right> = \frac{1}{N} \sum_{i=1}^N k_i = \sum_k k P(k)
\end{equation}
where $N$ is the total number of nodes in the network. The degree distribution also allows us to classify networks. The two most important classes are homogeneous and heterogeneous networks. Homogeneous networks have a bell curved degree distribution, eg. a Poisson distribution. In this case, most of the nodes have a degree closed to the average degree $\left<k\right>$. Heterogeneous networks, on the other hand, have a power-law degree distribution, $P(k) \sim k^{-\gamma}$. % explain differences  more, consequences of power-law + need to include figure?
They are also referred to as scale free networks, since they do not posses a characteristic length scale or, in this case, the average degree isn't a characteristic scale for the network \cite{Mata2020}. % correct statement?
%maybe explain why we care about degree, centrality measure etc

\subsection{Connectivity}
In physics literature, the degree of a node is often called the connectivity \cite{F.Costa2007}\cite{Mendes2002}. This is different from the mathematical/graph definition of connectivity, where connectivity refers to the minimum number of nodes or edges that need to be removed to separate the remaining nodes in isolated subgraphs.\\
Two nodes $u$ and $v$ of a graph are connected if there exist a path between them. If the two nodes are connected by a path that contains only one edge, the two nodes are called adjacent.\\
The average degree $\left<k\right>$ is a global measurement of the connectivity of the network \cite{Costa2008}. If the average connectivity $\left<k\right>$ is too small (this is, if there are too few edges), there will be many isolated nodes and only a few clusters with a small number of nodes. If more and more edges are added to the network, the small clusters will grow and will tend to connect to each other to form larger clusters. At some critical value of the connectivity, most nodes will be connected into a giant cluster (the giant component), which characterizes the percolation of the network \cite{F.Costa2007}.
% NOT finished; add this as a subsection in the degree section?? 

\subsection{Assortative and disassortative networks}

Another concept that is closely related to the degree of a node is the notion of assortative and disassortative networks. More precisely, the notion of assortativity and disassortativity has to do with degree correlations. \\
The joint degree distribution $P(k, k')$ is the probability that an arbitrary edge connects a node with degree $k$ to a node with degree $k'$ \cite{F.Costa2007}. The conditional probability $P(k|k')$, which is another way to express dependencies between node degrees, is the probability that an arbitrary neighbor of a node with degree $k$ has a degree $k'$ \cite{F.Costa2007}
\begin{equation}
	P(k|k') = \frac{\left<k\right>P(k, k')}{kP(k)}
\end{equation}
The average degree of the nearest neighbors of nodes with degree $k$ can be computed as \cite{F.Costa2007}
\begin{equation}
	k_{nn}(k) = \sum_{k'} k'P(k'|k)
\end{equation}
If there are no correlations $k_{nn}$ is independent of $k$, and such a network is called a neutral network \cite{F.Costa2007}. If $k_{nn}(k)$ is an increasing function of $k$, then nodes with a high degree tend to connect to nodes with a high degree and the network is classified as assortative. If instead $k_{nn}(k)$ is a decreasing function of $k$, nodes with a high degree tend to connect to nodes with a low degree and the network is called disassortative \cite{F.Costa2007}.\\
However, the terms assortativity and disassortativity are also often used without taking degree correlations into account. Instead, one may look at a particular node property to define assortative and disassortative network \cite{Thed2014}. In this way, an assortative network is a network where nodes tend to connect to other nodes with similar properties as themselves, whereas in a disassortative network nodes tend to connect to nodes with different properties \cite{Thed2014}.

% talk about assortativity of social networks?? + talk about node assortativity instead of global assortativity, see Thed2014?


\subsection{Network distances}

% explain length, diameter, average length,...
Several very useful measurements quantify the notion of length and distance in a network/graph. We start with the definition of a path: a path is a sequence of distinct nodes, such that adjacent nodes in the sequence are adjacent nodes in the network \cite{Goddard2010}. The length of a path is then defined as the number of edges in the path \cite{Goddard2010}. A geodesic path, often called the shortest path, between two nodes is the path between two nodes $i$ and $j$ with minimum length (note that the geodesic path is not necessarily unique) \cite{F.Costa2007}. The length of the geodesic path between the two nodes $i$ and $j$ is called the geodesic distance or shortest distance $d_{ij}$ \cite{F.Costa2007}. Geodesic distance is often just called distance \cite{Goddard2010}. The notion of distance enables to define several network measurements such as average distance, diameter and radius.\\  
\newline
\newline
\textbf{Average distance}\\
\newline
The average distance is the mean value of the geodesic distance $d_{ij}$ \cite{F.Costa2007}
\begin{equation}\label{avdist}
	l = \frac{1}{N(N-1)} \sum_{i \neq j} d_{ij}
\end{equation}
This definition, however, diverges if there are unconnected nodes in the network (unconnected nodes have, by definition, a distance equal to infinity) \cite{F.Costa2007}. This problem could be avoided by only including connected pairs in the sum, but this introduces a distortion for networks with a lot of unconnected pairs of nodes. These networks will then have a small average distance, which is only expected for networks with lots of connections \cite{F.Costa2007}. Instead, another definition of average distance is used: the global efficiency \cite{F.Costa2007}
\begin{equation}
	E = \frac{1}{N(N-1)} \sum_{i \neq j} \frac{1}{d_{ij}}
\end{equation}
This measurement quantifies the efficiency of the network in sending information between nodes \cite{F.Costa2007}. This assumes that the efficiency of sending information between two nodes is reciprocal to their distance \cite{F.Costa2007}. The harmonic mean of the geodesic distances is now defined as the reciprocal of the global efficiency
\begin{equation}
 	h = \frac{1}{E}
\end{equation}
\newline
\textbf{Diameter and radius}\\
\newline
The diameter $diam(G)$ of a network $G$ is the maximum distance between any pair of nodes \cite{Goddard2010}. The eccentricity of a node is the maximum distance from that node to any other node. The radius $rad(G)$ is the minimum eccentricity among all nodes of $G$. Note that the diameter is the maximum eccentricity among all nodes in $G$ \cite{Goddard2010}.
% finished?

\subsection{Clustering coefficient and transitivity}

The clustering coefficient is another important measure of network topology. It is a measure for the number of triangles in a network and determines the connectivity in the neighborhood of a node $i$: if a node $i$ has a high clustering coefficient, its neighbors are likely to be directly connected to each other \cite{Li2017}. \\Here a triangle is defined as a loop of length three, this is a sequence of nodes $x, y, z, x$ such that $\{x, y\}, \{y, z\}$ and $\{z, x\}$ are edges of the network. The clustering coefficient is thus a way to measure the degree to which nodes in a network tend to cluster \cite{Li2017}. The local clustering coefficient of a node $i$ is defined as
\begin{equation}\label{clus}
	C_i = \frac{2n_i}{k_i(k_i-1)}
\end{equation}
where $n_i$ is the number of edges that actually exist between the nodes in the neighborhood of $i$ and $k_i(k_i-1)/2$ is the maximum number of edges that could exist between them (note that this expression is only valid for an undirected graph, since for a directed graph $e_{ij} \neq e_{ji}$ and we have $k_i(k_i-1)$ possible edges between the neighbors of node i). % should give more mathimatical expression for n_i?
The average clustering coefficient is then given as the average of the local clustering coefficients
\begin{equation}\label{avClus}
	\bar{C} = \frac{1}{N}\sum_{i = 1}^N C_i
\end{equation}
where $N$ denotes, once again, the number of nodes in the network. The clustering coefficient is, beside a measure for the connectivity in the network, also linked to the robustness, or resilience against random damage,  of the network \cite{Iyer2013} \cite{Li2017}. \\
\newline
A measure that is closely related to the clustering coefficient is the transitivity $T$, defined as (valid for undirected, unweighted networks) \cite{F.Costa2007}
\begin{equation}\label{globalTrans}
	T = \frac{3 \times \text{number of triangles in the network}}{\text{number of connected triples of nodes in the network}}
\end{equation}
A connected triple is defined as a set of three nodes with at least two edges between them, so that each node can be reached from the other two (either directly or indirectly). The factor three arises from the fact that each triangle contributes to three different connected triples in the network: one centered at each node in the triangle \cite{F.Costa2007}. Let us denote the number of triangles as $N_{\Delta}$ and the number of connected triples as $N_3$. These two numbers can be obtained from the adjacency matrix in the following way \cite{F.Costa2007}
\begin{align}
	N_{\Delta} &= \sum_{k > j > i} A_{ij}A_{ik}A_{jk} \\
	N_3 &= \sum_{k > j > i} (A_{ij}A_{ik} + A_{ji}A_{jk} + A_{ki}A_{kj})
\end{align}
where $A_{ij}$ are the elements of the adjacency matrix. It is possible to define the transitivity of one node as \cite{F.Costa2007}
\begin{equation}\label{trans}
	T_i = \frac{N_{\Delta}(i)}{N_3(i)}
\end{equation}
where $N_{\Delta}(i)$ represents the number of triangles that involve node $i$ and $N_3(i)$ is the number of connected triples with $i$ as the central node \cite{F.Costa2007}
\begin{align}
	N_{\Delta}(i) &= \sum_{k > j} A_{ij}A_{ik}A_{jk} \\
	N_3(i) &= \sum_{k > j} A_{ij}A_{ik}
\end{align}
It is not too hard to see that $N_{\Delta}(i)$ counts the number of edges between the neighbors of $i$ and that $N_3(i)$ is equal to $k_i(k_i-1)/2$, where $k_i$ is the degree of node $i$. It is thus obvious that the local clustering coefficient $C_i$ (Eq. (\ref{clus})) of a node and the transitivity $T_i$ (Eq. (\ref{trans})) of a node define the same quantity \cite{F.Costa2007}. In the case of the average clustering coefficient $\bar{C}$ and the global transitivity $T$ this is, however, not the case. The difference between the two definitions is that the average of Equation (\ref{globalTrans}) gives the same weight to each triangle in the network, whereas Equation (\ref{avClus}) gives the same weight to each node. This may lead to slightly different values since nodes with a higher degree may possibly be involved in a higher number of triangles than nodes with a lower degree \cite{F.Costa2007}.
	
\subsection{Network communities}

% continue working on this based on http://networksciencebook.com/chapter/9#basics and https://arxiv.org/pdf/1503.06277.pdf

Network communities is another feature that (complex) networks may posses. A community inside a network is loosely defined as a set of nodes that are more densely connected to nodes inside that set than to the other nodes in the network \cite{Saha2015}. More strictly, a community is defined based on two hypotheses: the connectedness hypothesis and the density hypothesis \cite{Albert2016}. In short, the connectedness hypothesis means that each member of a community should be reached through each other member of the same community \cite{Albert2016}. The density hypothesis implies that nodes inside a community are more likely to be linked to other nodes inside that community than to nodes outside the community \cite{Albert2016}. The density hypothesis narrows what could be considered a community, but it doesn't uniquely define it. Several community definitions are consistent with the density hypothesis. Let us consider three possible definitions: maximum cliques, strong community and weak community \cite{Albert2016}.\\
\newline
\textbf{Maximum cliques}\\
\newline
A clique is a complete subgraph, where a complete subgraph is defined as a set of nodes of the network where each node in the set is directly connected to all the others nodes in the same set \cite{Albert2016}. A community based on this definition would then be the largest clique in the network. This definition of community might, however, be too restrictive and, beside that, large cliques don't appear very frequent in networks \cite{Albert2016}.\\   
\newline
\textbf{Strong communities}\\
\newline
A strong community is defined such that each node inside the community has more edges to other nodes inside the same community than to nodes outside the community \cite{Albert2016}. Let us denote a community as $C$ and let $i$ be a node inside the community $C$. If we define the internal degree $k_i^{int}(C)$ as the number of edges of node $i$ with other nodes in $C$ and the external degree $k_i^{ext}(C)$ as the number of edges of node $i$ with nodes outside $C$, then we have the following condition for $C$ to be a strong community \cite{Albert2016}
\begin{equation}
	k_i^{int}(C) > k_i^{ext}(C) \qquad \forall i \in C
\end{equation}
\newline
\textbf{Weak communities}\\
\newline
A weak community is a community where the sum of the internal degree of all the nodes in the community exceeds the sum of the external degree of all the nodes in the community \cite{Albert2016}. We thus have the following condition for a weak community $C$ \cite{Albert2016}
\begin{equation}
	\sum_{i \in C} k_i^{int}(C) > \sum_{i \in C}k_i^{ext}(C)
\end{equation}

\subsection{Modularity}

The modularity $Q$ is a measurement that represents the quality of a particular division of a network into different communities \cite{F.Costa2007}. It was proposed after the fundamental problem arised for real networks concerning how to best divide the network into its constituent communities \cite{F.Costa2007}. Generally, no a priori information is available about the number of existing communities in real networks \cite{F.Costa2007}.\\
The modularity for a network with $N$ nodes and $L$ edges and partitioned into $n_c$ communities is calculated as follows. Each community has $N_c$ nodes and $L_c$ edges ($c = 1,..., n_c$) \cite{Albert2016}. The modularity of a community $Q_c$ is then calculated by measuring the difference between the network real wiring diagram (which is given by the adjacency matrix $A_{ij}$) and the expected number of edges between $i$ and $j$ if the network is randomly wired (where $i$ and $j$ are two nodes that lie in the same community $C_c$) \cite{Albert2016}. This last quantity is given by $p_{ij}$ which is obtained by randomizing the original network while keeping the expected degree of each node unchanged \cite{Albert2016}. Hence, the modularity of a community $Q_c$ becomes \cite{Albert2016}
\begin{equation}
	Q_c = \frac{1}{2L}\sum_{(i,j) \in C_c} (A_{ij} - p_{ij})
\end{equation}
where the factor $\frac{1}{2L}$ is just a normalization factor. Using \cite{Albert2016}
\begin{equation}
	p_{ij} = \frac{k_ik_j}{2L}
\end{equation}
we can derive a simpler form for $Q_c$ \cite{Albert2016}
\begin{equation}\label{Qc}
	Q_c = \frac{L_c}{L} - \bigg(\frac{k_c}{2L}\bigg)^2
\end{equation}
where $L_c$ is the total number of edges in the community $C_c$ and $k_c$ is the total degree of the nodes in this community \cite{Albert2016}.\\
To generalize this idea to the whole network, we sum Eq. (\ref{Qc}) over all $n_c$ communities \cite{Albert2016}
\begin{equation}\label{mod}
	Q = \sum_{c = 1}^{n_c}\bigg[\frac{L_c}{L} - \bigg(\frac{k_c}{2L}\bigg)^2 \bigg]
\end{equation}
The derivation of this formula and thus of Eq. (\ref{Qc}) can be found in Appendix \ref{modul}, Section \ref{simplemod}. The modularity $Q$ can have values in the interval $\interval{-1}{1}$ and has the following properties \cite{Albert2016}
\begin{itemize}
	\item The higher the value of $Q$ is for a partition, the better is the corresponding community structure. This idea is used in community detection algorithms, where modularity is maximized in order to find the optimal community structure.
	\item A modularity $Q$ equal to zero corresponds to the situation where all nodes are put in the same community, this is if the whole network is put into a single community. Then the two terms in Eq. (\ref{mod}) become equal and $Q$ vanishes.
	\item If every node is put into a separate community, the first term in Eq. (\ref{mod}) vanishes and we are left with $n_c$ negative terms. Hence, this situation corresponds to a negative modularity.
\end{itemize}
As said before, modularity is often used in community detection algorithms. It is thus important to be aware of the limitations of modularity. One of the biggest shortcomings of modularity maximization as community detection is its resolution limit. Modularity maximization forces small communities into larger ones \cite{Albert2016}. If two communities $A$ and $B$ are merged, the modularity changes by \cite{Albert2016}
\begin{equation}
	\Delta Q_{AB} = \frac{l_{AB}}{L} - \frac{k_Ak_B}{2L^2}
\end{equation}
where $l_{AB}$ is the number of direct edges that connect nodes in community $A$ with nodes in community $B$; $k_A$ and $k_B$ are the total degree of nodes in communities $A$ and $B$ respectively. The derivation of this formula is found in Appendix \ref{modul}, Section \ref{modchange}. If $A$ and $B$ are distinct communities, they should remain distinct when $Q$ is maximized \cite{Albert2016}. This is however not always the case. Consider the case where $\frac{k_Ak_B}{2L} < 1$ and there is at least one edge between $A$ and $B$ ($l_{AB} \geqslant 1$), then $\Delta Q_{AB} \geqslant 0$ and the modularity increases by merging the two communities \cite{Albert2016}. Assume for simplicity that $k_A = k_B = k$, then modularity is increased by merging $A$ and $B$ if
\begin{equation}\label{reslim}
	k \leqslant \sqrt{2L}
\end{equation}
and if there is at least one edge between the two communities; even if $A$ and $B$ are distinct communities \cite{Albert2016}! Equation (\ref{reslim}) is called the resolution limit: communities that are smaller than this limit will not be detected by modularity maximization \cite{Albert2016}.



% talk about what is a graph, talk about degree distribution, clustereing, average path length, etc (in different subsections), maybe things like assortativity, page rank,...
% explain small-world (milgram), high clustering, power-law

\section{Network models}
\label{netModel}

In order to study the topological structures of real-world networks, several theoretical network models have been developed. These theoretical models usually have a simpler representation and well known properties that can be derived analytically. They are widely studied and used extensively. The study of complex networks relies heavily on the knowledge and understanding of these models. In this section we will review some of the most important ones.

\subsection{The Erd\H{o}s-R\'{e}nyi model}

In 1959 the two mathematicians Paul Erd\H{o}s and Alfr\'{e}d R\'{e}nyi proposed a model to generate simple random networks \cite{F.Costa2007}. Independently of them, Solomonoff and Rapoport already proposed the model in 1951. The model constructs random networks with $N$ nodes in the following way \cite{Albert2002}
\begin{enumerate}
	\item Start with $N$ disconnected nodes,
	\item For each pair of nodes, connect them with a predefined probability $p$.
\end{enumerate} 
If $p=1$, we obtain a network with the maximum number of edges $N(N-1)/2$. This is called the fully connected network.\\
\newline
\textbf{Degree distribution and average degree}\\
\newline
The probability that a node is connected to $k$ other nodes and not to $N-k$ others is given by
\begin{equation}
	p^k (1-p)^{N-1-k}
\end{equation}
The number of ways to choose the $k$ nodes among the $N-1$ possible candidates is given by the binomial coefficient
\begin{equation}
	\binom{N-1}{k} = \frac{(N-1)!}{k!(N-1-k)!}
\end{equation}
and the probability of being connected to exactly $k$ other nodes becomes
\begin{equation}\label{degDistRan}
	p_k = \binom{N-1}{k}p^k (1-p)^{N-1-k}
\end{equation}
We thus derived the degree distribution of a random network. From this we can calculate the average degree of the network. The expected mean degree is given by \cite{Hopcroft2006}
\begin{equation}\label{avDeg}
\begin{split}
	\left<k\right> &= \sum_{k=0}^{N-1} k\  p_k  \\
&= \sum_{k=0}^{N-1} k \binom{N-1}{k}p^k (1-p)^{N-1-k}
\end{split}
\end{equation}
This equation can be simplified to $\left<k\right> = (N-1)p$, and for $N \gg 1$ this approximately becomes $\left<k\right> = Np$. The derivation of this result can be found in Appendix \ref{ER}, Section \ref{degree}.\\
Most real networks are sparse, which means that $\left<k\right> \ll N$. In this case the degree distribution of the random network is well approximated by a Poisson distribution \cite{Albert2014} 
\begin{equation}
	p_k = \mathrm{e}^{-\left<k\right>} \frac{\left<k\right>^k}{k!}
\end{equation}
The derivation can be found in Appendix \ref{ER}, Section \ref{poiss}. \\
\newline
\newline
\newline
\textbf{Average clustering coefficient}\\
\newline
The average clustering coefficient (Eq. (\ref{globalTrans})) of the Erd\H{o}s-R\'{e}nyi network is given by \cite{Clauset2011}
\begin{equation}\label{C}
	\bar{C} = \frac{\binom{N}{3}p^3}{\binom{N}{3}p^2} = p = \frac{\left<k\right>}{N-1}
\end{equation}
This can be easily understood since choosing three nodes out of $N$ is given by $\binom{N}{3}$. The chance that they are connected by three edges is given by $p^3$, which gives the number of triangles; the chance that the are connected by two edges is $p^2$, which determines the number of connected triples. If the average degree $\left<k\right>$ is constant, the average clustering constant goes as $\bar{C} \sim \mathcal{O}(1/N)$, which becomes very small for large networks \cite{Clauset2011}. \\
\newline
\textbf{Diameter and average distance}\\
\newline
A heuristic derivation of the diameter of a random network goes as follows. Consider a random network with average degree $\left<k\right>$, then a node in this network has on average \cite{Albert2014}
\begin{itemize}
	\item $\left<k\right>$ nodes at distance one $(d=1)$
	\item $\left<k\right>^2$ nodes at distance two $(d=2)$
	\item $\left<k\right>^3$ nodes at distance three $(d=3)$
	\item ...
	\item $\left<k\right>^d$ nodes at distance $d$
\end{itemize}
The number of nodes at a distance $d$ cannot exceed the number of nodes $N$ in the network. We thus obtain the following equation from which the maximum distance or diameter $d_{max}$ can be obtained
\begin{equation}
	N \approx \left<k\right>^{d_{max}}
\end{equation}
or 
\begin{equation}\label{diameter}
	d_{max} \approx \frac{\ln{N}}{\ln{\left<k\right>}}
\end{equation}
A more precise calculation can be found in Appendix \ref{ER}, Section \ref{ERdist}. Equation (\ref{diameter}) might, however, be a better approximation to the average distance $\left<d\right>$ between two randomly chosen nodes \cite{Albert2014}. This is because $d_{max}$ is often dominated by a few extreme paths, where $\left<d\right>$ instead is averaged over all node pairs and thus suppresses these fluctuations \cite{Albert2014}. Hence, the average distance of a random network is defined by \cite{Albert2014}
\begin{equation}\label{d}
	\left<d\right> \approx \frac{\ln{N}}{\ln{\left<k\right>}}
\end{equation}
Since for large $N$, $\ln{N} \ll N$, and we find that the average distance is a lot smaller than the size of the network. Generally, the logarithmic dependence of the average distance $\left<d\right>$ on the network size $N$ is one of the two defining properties of what is referred to as the "small world phenomenon"; the other property is a high clustering coefficient \cite{Easley2010}.  \\
\\
To summarize: the random Erd\H{o}s-R\'{e}nyi network has a bell shaped degree distribution which approximates a Poisson distribution for $N \gg 1$; the average clustering coefficient becomes small for large networks and the average distance depends logarithmic on the system sizes. The Erd\H{o}s-R\'{e}nyi network thus possesses one of the two properties of the "small world phenomenon" (namely short average distance).\\
Real social networks, however, usually display the "small world phenomenon" and thus have both a short average distance and a high clustering coefficient. The question then rises: can we construct a model that has both of these properties? The answer is yes and this is exactly what Duncan Watts and Steve Strogatz did.
% also take about the giant cluster, critical probability??

\subsection{The Watts-Strogatz model}

In 1998, Duncan Watts and Steve Strogatz constructed a network model that generates random networks with small world properties, such as high clustering and short average distances. Their model achieves this by interpolating between a regular ring lattice and a random network \cite{Watts1998}. The construction goes as follows \cite{Watts1998}
\begin{enumerate}
	\item Start with a regular ring lattice with $N$ nodes, each connected to $K = 2m$ neighbors ($m$ on each side)
	\item For each node $i$, rewire each edge that connects $i$ with its $K/2$ rightmost neighbors with a probability $p$. Rewiring is done in such a way that self-loops and edge duplication are avoided
\end{enumerate}
The probability $p$ allows us to tune the graph between a regular lattice ($p = 0$) and a random network ($p = 1$) \cite{Watts1998}. Usually, the following condition is required for the number of neighbors $K$: $N \gg K \gg \ln{N} \gg 1$. The first inequality assures sparse networks, whereas the second inequality guarantees that a random graph will be connected \cite{Watts1998}.\\
The regular ring lattice ($p=0$) has an average clustering coefficient $\bar{C}(0)$ and an average path length $\left<d(0)\right>$ equal to \cite{Watts1998}
\begin{align}\label{C0}
	\bar{C}(0) = \frac{3(K-2)}{4(K-1)} \approx \frac{3}{4} \ \text{for}\ K \gg 1 && \left<d(0)\right> \approx \frac{N}{2K}
\end{align}
The derivations of these formulas can be found in Appendix \ref{WS}, Section \ref{ringclus}. The regular ring lattice thus has a high clustering coefficient and an average path length that grows linearly with the system size $N$. \\
The random network ($p = 1$) on the other hand has a low clustering coefficient $\bar{C}(1)$ and a small average path length $\left<d(1)\right>$ (see Eq. (\ref{C}) and Eq. (\ref{d})) \cite{Watts1998}
\begin{align}
	\bar{C}(1) \approx \frac{K}{N} \ll 1 && \left<d(1)\right> \approx \frac{\ln{N}}{\ln{K}}
\end{align}
Watts and Strogatz then showed by numerical simulation that the average distance for the networks with $0 < p < 1$ is comparable with the average distance of a random graph, even for small $p$ \cite{Newman2000}. The clustering coefficient is approximately given by   \cite{Barrat1999}
\begin{equation}
	\bar{C} \approx \bar{C}(0)(1-p)^3
\end{equation} 
where $\bar{C}(0)$ is given by Equation (\ref{C0}). This can be seen in the following way
\begin{itemize}
	\item The probability that none of the three edges of the original triangles in the regular lattice are rewired is $(1-p)^3$
	\item The probability that edges are rewired back to each other is negligible
\end{itemize}
For rather small values of $p$, the clustering coefficient remains high. The model of Watts and Strogatz is thus able to generate random networks with a high clustering coefficient and short average distances.

% also discuss case where edges are added instead of rewired??

\subsection{The stochastic block model}

Another random graph model is one that produces networks containing a community structure, namely the stochastic block model (SBM). The stochastic block model originates in social sciences and was developed to describe group structures in friendship networks \cite{Funke2019}. The idea behind the development of this model is that often in real networks, there are groups of nodes that are more densely interconnected with each other than with the rest of the network \cite{F.Costa2007}. Hence, these networks posses a modular/community structure and this is exactly the structure that is easily modeled by the stochastic block model. The stochastic block model is also often used as a benchmark for community detection algorithms.\\
\newline
The stochastic block model in its most simple form is defined by the following parameters \cite{Clauset2017}
\begin{itemize}
	\item The number of nodes $N$ 
	\item A partition of the node set $\{1, 2, ..., N\}$ into disjoint subsets $C_1, ..., C_k$; these groups are the communities
	\item A symmetric $k\times k$ matrix $M$; the diagonal elements $M_{ii}$, $i = 1, ..., k$ represent the edge probabilities inside the community $C_i$ and the off-diagonal elements $M_{ij}$, $i, j = 1, ..., k$ with $i \neq j$, give the edge probabilities between nodes in community $C_i$ and nodes in community $C_j$
\end{itemize}
There are no real restrictions to the edge probabilities, which makes the stochastic block model a very general model that is capable of reproducing many different network structures. However, the edge probabilities inside a community are often taken to be bigger than the probabilities between communities ($M_{ii} > M_{ij}$, $i \neq j$). In this way, the stochastic block model generates a network with a clear community structure. A stochastic block model that fulfills this condition is called an assortative SBM \cite{Lee2019}. A disassortative stochastic block model refers to the case where the edge probabilities between the communities are higher than those inside the communities ($M_{ii} < M_{ij}$, $i \neq j$) \cite{Gribel2020}.\\
\newline
The stochastic block model includes the Erd\H{o}s-R\'{e}nyi model \cite{Clauset2017}. This can be seen in the two different ways. First, consider the case where $k = 1$, thus we only have one group. The matrix $M$ then reduces to one number $p$ and we are left with the parameters $N$ and $p$ of the Erd\H{o}s-R\'{e}nyi model \cite{Clauset2017}. Second, assume we have more than one group or community, $k > 1$, and assume that every element of the matrix $M$ is the same, $M_{ij} = p$ \cite{Clauset2017}. Again, we are left with the parameters $N$ and $p$ of the Erd\H{o}s-R\'{e}nyi model. In both cases, the mathematical properties of the Erd\H{o}s-R\'{e}nyi model are obtained: a Poisson degree distribution, an average distance that is logarithmic with the system size $N$, vanishing clustering coefficient for large $N$, etc \cite{Clauset2017}. The structure within the groups or communities of the stochastic block model is that of a random graph, while the structure between the communities is that of a random bipartite graph \cite{Clauset2017}.\\
In this thesis, the stochastic block model is generated in the following way. First, the parameters of the model are specified. Then, for each community $C_i$ an Erd\H{o}s-R\'{e}nyi network is constructed, where the number of nodes equals the size of the community $C_i$ and the edge probability $p$ is given by $M_{ii}$. Finally, edges are added between communities $C_i$ and $C_j$ with probability $p = M_{ij}$.\\
The stochastic block model can be fitted to data \cite{Clauset2017}. Given a choice of the number of communities $k$ and an observed network $G$, the stochastic block model can be used to infer the latent community structure and the edge probability matrix $M$ \cite{Clauset2017}.\\
One of the shortcomings of fitting the SBM to infer the community structure, is that real-world networks often have a heterogeneous or power law degree distribution. Since the SBM is made of random networks inside each group and random bipartite networks between each pair of groups, the degree distribution of the full network is always a mixture of Poisson distributions \cite{Clauset2017}. The consequence of this is that if a network possesses a more skewed degree distribution, the SBM will put the nodes with a high degree in a small group, together with a high probability of connecting to other, larger groups \cite{Clauset2017}. The reason behind this is one of the main assumptions of the stochastic block model, namely the fact that the edge probabilities only depend  on which group the node belongs to \cite{Clauset2017}. In other words, nodes that belong to the same group are stochastically  equivalent, meaning that they have equivalent connectivity patterns to other nodes \cite{Clauset2017}. However, a network with a skewed degree distribution violates this assumption of edge independence and the SBM seeks to explain this over other kinds of latent group structures that we might care about \cite{Clauset2017}. Karrer and Newman proposed a variation of the SBM, the degree corrected SBM, that deals with this limitation \cite{Karrer2011}. 
% talk about community sizes from power law??
% NOT FINISHED
% different subsections where you talk about different graph models: erdos-renyi, clustered random, wats strogatz, barabasi albert, etc...

\section{Real-world social networks}
The models discussed in the sections above, describe real-world networks in an idealized, simplified way. They may posses some of the characteristics of real-world networks, but they certainly do not always describe real-world networks appropriately. The question then arises: what are the main properties/characteristics of real-world networks, and more specifically of real-world social networks? Another important question that can be asked is whether or not there is a significant difference between off-line social networks and on-line social networks?\\
\newline
As already briefly discussed in the introduction, it is found that real-world networks often posses three characteristic properties. These are the two properties of the "small world phenomenon", namely a short average distance and a high clustering coefficient, and a heterogeneous or power law degree distribution \cite{RealWorld}. These properties are valid for both off-line and on-line social networks \cite{Zhang2014}. Lets discuss them in a bit more detail.\\
\newline
\newline
\textbf{Short average distance}\\
\newline
In the late 1960's Stanley Milgram performed a, what is now famous, experiment. He asked randomly selected people in Boston and Omaha to forward a letter to a distant target person. The letter could, however, only be sent to acquaintances, thought to be closer to the target person \cite{RealWorld}. The remarkable result of this experiment was that the average number of steps between the sender and the target person was only around six. This phenomenon is now often referred to as "six degrees of separation" \cite{RealWorld}.\\
This phenomenon is also observed in many other real-world networks: in most real-world networks it is possible to go from one node to another node through a number of edges that is small compared to the system size \cite{RealWorld}. Such networks usually have an average distance that depends logarithmically on the system size instead of linearly. A short average distance facilitates a fast transmission of information \cite{Zhang2014}.\\
\newline
\textbf{High clustering coefficient}\\
\newline
In real-world social networks, one often observes the pattern that two acquaintances/friends of an individual are also acquaintances/friends of each other \cite{RealWorld}. In graph terminology, this is translated into a high clustering coefficient (which quantifies a large number of triangles in the network) \cite{RealWorld}. This property is not only found in social networks, but also in a wide variety of different real-world networks \cite{RealWorld}.\\
\newline
\textbf{Heterogeneous or power law degree distribution}\\
\newline
Many real-world networks are found to have a power law degree distribution \cite{RealWorld}
\begin{equation}
	P(k) \sim k^{-\gamma}
\end{equation}
where the exponent $\gamma$ often lies between 2 and 3. Networks with a power law degree distribution are also called heterogeneous or scale free networks. The term scale free refers to the fact that there is no characteristic scale in the network. Compared to the homogeneous network, where each node has a degree close to the average degree $\left<k\right>$, the heterogeneous network has many nodes with a low degree and a few nodes with a very high degree (these nodes are referred to as hubs). If the exponent $\gamma$ is smaller or equal to two ($\gamma \leqslant 2$), the average degree diverges; if $2 < \gamma < 3$, there is a finite average degree, but a diverging variance \cite{Newman2005}.\\
\newline
As said earlier, these three main characteristics are valid for on- and off-line social networks. Another property that is found in most on- and off-line networks is the appearance of a giant component, this is, most nodes belong to the same connected component \cite{Latapy}. They also often posses a modular/community structure \cite{Ferrara2012}\cite{McGlohon2011}. \\
There are, however, some properties that are different between on-line and off-line networks as well. One of them might be the degree correlations/mixing pattern. It is commonly assumed and accepted that most real-life social networks have an assortative mixing pattern (this distinguishes them from other real-world networks, eg. biological networks \cite{F.Costa2007}, which often have a disassortative pattern) \cite{Hu2009}\cite{Zhang2014}. For a long time, it was thought that this is also valid for on-line social networks. However, recent research has shown that a lot of on-line social networks display disassortative mixture \cite{Hu2009}\cite{Zhang2014}. This discrepancy between real-life social networks and on-line social networks may be explained as follows. In real-life, `ordinary people' often want to be friends with celebrities, however, the celebrities usually prefer to stay within their own circles \cite{Hu2009}\cite{Zhang2014}. The `ordinary people' don't have access to these circles and we are left with the situation where `ordinary people' interact with `ordinary people' and celebrities hang out among other celebrities; hence, an assortative structure. In on-line social networks, `ordinary people' can easily connect with the celebrity and vice-versa, the celebrity wants to show his/her importance/influence by the number of fans \cite{Hu2009}\cite{Zhang2014}. This leads to a disassortative mixing pattern.
% also talk about size of groups that people can maintain?

\chapter{Opinion dynamics}
\label{chap3}
The study of opinion dynamics in a group of people, as already mentioned in the introduction, has two major layers: a network layer and an opinion dynamics layer. The network layer, which describes the underlying structure and correlations between the agents/people, is intensively described in the previous chapter, Chapter \ref{chap2}. This chapter focuses on the second important layer, namely that of the opinion dynamics models. These models need to describe, in a simplified way, how opinions are formed and how they evolve in a group of people that interact in a certain way. Hence, these opinion dynamics are the dynamics that run on the underlying network structure. Several models have been proposed; here we will review some of the most important ones, with the main focus on the models used in this thesis.\\
Some major attention will also be given to the content curation/filtering algorithms used by social media companies (see Section \ref{filter}). This is needed because this thesis deals with opinion dynamics on on-line social media, so the aspect of filtering cannot be ignored in the formation and evolution of opinions.\\
\newline
There will also be some attention on the activation mechanism (see Section \ref{actMech}). This is the mechanism that describes the timings in which content/information is exchanged between users \cite{Perra2019}. Such a mechanism may change the network from a static one to a more temporal one, where nodes become active and inactive over time. \\
\newline
There are two major groups of opinion dynamics models, namely binary/discrete models and continuous approaches. These will be discussed in the following two sections, Section \ref{Bin} and Section \ref{Con}, respectively. This thesis only deals with binary opinion dynamics models, so these will be thoroughly described; the continuous models will be quickly reviewed in order to give a more complete overview.\\
\newline
Finally, in Section \ref{stubb}, the introduction of stubborn people is discussed and, in Section \ref{thesisOp}, a summary of the opinion dynamics model used in this thesis is given.

\section{Binary models}\label{Bin}
% Talk about Ising model???

Binary models are models where each agent can have one of the two opinions A or B (or, equivalently, 0 or 1). A binary model could reflect real-life cases where there exist two competing opinions, such as a vote in an election system with two competing candidates or choosing between Windows and Linux \cite{Nguyen2020}.

\subsection{The majority model}

One of the simplest opinion dynamics models is the binary majority model. In this model each agent has one of the two opinions A or B (or 0 or 1). Initially, these opinions can be equally distributed or not. If the distribution is not equal, but instead eg. 80/20, there is a predominant opinion and a minority opinion.\\
The following updating rule is then imposed on the network: each agent/individual adopts the majority opinion of his/her nearest neighbors \cite{Nguyen2020}. Thus, initially each agent has an opinion, then the opinions are evolved in time: each individual iteratively updates his/her opinion according to the majority opinion of his/her direct neighbors \cite{Nguyen2020}.\\
\newline
Several studies have been performed on this kind of model, searching for answers on several questions such as: what are the conditions that drive such a system to converge to unanimity; and, does an opinion, that is initially a majority opinion, remain a majority opinion in the final state \cite{Nguyen2020}? \\
Most of these studies conclude that, at the end of the opinion evolution, a complete consensus state is obtained where all the agents adopt the same opinion \cite{Nguyen2020}. This is even the case when the opinions are equally and randomly distributed in an Erd\H{o}s-R\'{e}nyi network (with the side note that the degree needs to be high enough), as was shown by Benjamini, Chan, O'Donnell, Tamuz and Tan (also note that even when the opinions are equally distributed, there may still be a slight imbalance due to the random assignement of an opinion to each node; instead of a perfect 50/50 distribution, one may end up with a eg. 49.8/50.2 distribution; in this sense there is still some kind of notion of `minority' and `majority' opinion) \cite{Benjamini2016}. It is also found that the rate of convergence increases with increasing edge density and that if the network is sparse enough, consensus will not be reached and the two opinions coexist \cite{Nguyen2020}.
% https://arxiv.org/pdf/0710.3256.pdf Contains a mean field mathimatical description, interesting?

\subsection{The probabilistic majority model}

The probabilistic majority model is similar to the majority model, but has, as the name suggests, a more probabilistic/random nature. In this model the fractions of neighbors of user $i$ with opinion A and B are determined. Then, the opinion of user $i$ is updated: he/she takes on opinion A (or B) with a probability equal to the fraction of his/her neighbors with opinion A (or B) \cite{Perra2019}.\\
For example, if $70\%$ of the neighbors of user $i$ have an opinion A (and thus $30 \%$ of the neighbors has opinion B), user $i$ will updates his/her opinion to opinion A with a probability 0.7 and to opinion B with a probability 0.3 \cite{Perra2019}. Thus, user $i$ no longer simply updates his/her opinion according to the majority of opinions carried by his/her neighbors, but the majority opinion still has a higher probability to be taken on by this user.\\
This model is no longer deterministic, but has a level of randomness, which is an important component of opinion dynamics \cite{Perra2019}. 
% https://arxiv.org/pdf/0710.3256.pdf read this (overview, discusses several models)!!

\subsection{The Voter model}
% https://arxiv.org/pdf/0710.3256.pdf

\section{Continuous models}\label{Con}
% https://arxiv.org/pdf/0710.3256.pdf, bounded confidence methods
% https://www.researchgate.net/publication/235737446_Mixing_Beliefs_Among_Interacting_Agents defuant model
% http://jasss.soc.surrey.ac.uk/5/3/2/2.pdf
% http://jasss.soc.surrey.ac.uk/9/3/8.html

\section{Algorithmic personalization}\label{filter}

On-line social platforms use algorithms to order and filter the posts that appear on the time line of an individual \cite{Perra2019}. They do this in order to make the experience on their platforms more pleasant, interesting and convenient \cite{Perra2019}. If social media companies woudn't use any kind of filtering, there would be way to many content to handle and process for the social media user \cite{Bozdag2013}. This in turn would make the on-line social experience a lot more unpleasant and inconvenient; the user might feel overwhelmed by the number of information he/she is exposed to \cite{Bozdag2013}. The reason behind this is that people are cognitive and time constrained \cite{Perra2019}; hence, there is only a limited amount of information that human beings can process \cite{Bozdag2013}.\\
\newline
The backside of such algorithmic filtering is that it fine-tunes the information it shows based on the user. Even two users with the same friends may then be exposed to different content, based on their previous activities and history \cite{Bozdag2013}. This may lead to the formation of echo chambers in which users get `trapped' in content that confirms their own mindset \cite{Bozdag2013}. \\
It is thus important to know and be aware of the possible impacts of algorithmic personalization on the formation and evolution of opinions. Prof. Nicola Perra and prof. Luis E.C. Rocha already partly investigated the role of such algorithms on the dynamics of opinions in several networks in one of their previous papers, \textit{Modelling opinion dynamics in the age of algorithmic personalization} (see reference \cite{Perra2019}). Since filtering algorithms are often not transparently shared by social media companies, they proposed several personalization algorithms based on three simple ways of filtering \cite{Perra2019}
\begin{itemize}
	\item Popularity filtering: promoting content that is popular across the platform
	\item Semantic filtering: promoting posts that are similar to previous consumed posts
	\item Collaborative filtering: promoting content that people similar or close to us consume
\end{itemize} 
The following paragraph briefly reviews the filtering algorithms that prof. Nicola Perra and prof. Luis E.C. Rocha proposed. \\
\newline
At every time $t$ each platform user has a hidden list $L_i(t)$ that contains all the opinions/posts that he/she received from his/her friends \cite{Perra2019}. The filtering algorithm then selects $Q$ items from this list and shows them on the user's time line; the following selection methods are used \cite{Perra2019}
\begin{itemize}
	\item The reference method (REF): this method randomly selects $Q$ items from the list $L_i(t)$
	\item The old method (OLD): the $Q$ oldest post in $L_i(t)$ are displayed on the time line of the user
	\item The recent method (REC): shows the $Q$ most recent items from $L_i(t)$
	\item The preference method (PR): sorts the hidden list $L_i(t)$ according to the current opinion of the user and then selects the first $Q$ elements
\end{itemize}
Prof. Nicola Perra and prof. Luis E.C. Rocha showed that the REF, OLD and REC methods behave similar in many cases and that the PR method often displays different behavior (such as a larger formation of echo chambers compared to the other three methods) \cite{Perra2019}. In this thesis the REC method is mainly used as a reference/benchmark method and the PR method is used as the main filtering algorithm.

\section{The activation mechanism}\label{actMech}

\section{The presence of stubborn people}\label{stubb}

\section{The opinion dynamics model used in this thesis}\label{thesisOp}


% https://arxiv.org/pdf/0710.3256.pdf Talk about agent-based models??

\newpage

\appendix
\chapter{Network measurements: Derivations}
\section{Modularity}\label{modul}
\subsection{Simple form of network modularity}\label{simplemod}

Using \cite{Albert2016}
\begin{equation}
	Q_c = \frac{1}{2L}\sum_{(i,j) \in C_c} (A_{ij} - p_{ij})
\end{equation}
and \cite{Albert2016}
\begin{equation}
	p_{ij} = \frac{k_ik_j}{2L}
\end{equation}
we can write the modularity of the whole network as \cite{Albert2016}
\begin{equation}\label{modnetw}
	Q = \frac{1}{2L}\sum_{i, j = 1}^N \bigg(A_{ij} - \frac{k_ik_j}{2L}\bigg) \delta_{c_i, c_j}
\end{equation}
where $c_i$ represents the community to which node $i$ belongs and where the Dirac-delta function $\delta_{c_i, c_j}$ expresses that only pairs of nodes that belong to the same community are taken into account. We can then rewrite the first term as a sum over communities \cite{Albert2016}
\begin{equation}\label{1}
	\frac{1}{2L}\sum_{i, j = 1}^N A_{ij}\delta_{c_i, c_j} = \sum_{c=1}^{n_c}\frac{1}{2L}\sum_{i, j \in C_c} A_{ij} = \sum_{c=1}^{n_c}\frac{L_c}{L}
\end{equation}
where $L_c$ is the number of edges in community $C_c$ and the factor 2 disappears because each edge is counted twice in $A_{ij}$. Similarly, the second term in Eq. (\ref{modnetw}) can be rewritten as \cite{Albert2016}
\begin{equation}\label{2}
	\frac{1}{2L}\sum_{i, j = 1}^N \frac{k_ik_j}{2L} \delta_{c_i, c_j} = \sum_{c=1}^{n_c}\frac{1}{(2L)^2}\sum_{i, j \in C_c} k_ik_j = \sum_{c=1}^{n_c}\frac{k_c^2}{4L^2}
\end{equation}
where $k_c$ is the total degree of the nodes in community $C_c$. Combining Eq. (\ref{1}) and Eq. (\ref{2}) gives the final result \cite{Albert2016}
\begin{equation}\label{Qfin}
	Q = \sum_{c = 1}^{n_c}\bigg[\frac{L_c}{L} - \bigg(\frac{k_c}{2L}\bigg)^2 \bigg]
\end{equation}

\subsection{Modularity change after merging two communities}\label{modchange}

Consider two communities $A$ and $B$ and denote with $k_A$ and $k_B$ the total degree of communities $A$ and $B$ respectively \cite{Albert2016}. The change in modularity after merging the two communities is calculated as follows (using Eq. (\ref{Qfin})) \cite{Albert2016}
\begin{equation}\label{Q_AB}
	\Delta Q_{AB} = \bigg[\frac{L_{AB}}{L} - \bigg(\frac{k_{AB}}{2L} \bigg)^2 \bigg] - \bigg[\frac{L_A}{L} - \bigg(\frac{k_A}{2L} \bigg)^2 + \frac{L_B}{2L} - \bigg(\frac{k_B}{2L} \bigg)^2 \bigg]
\end{equation}
where $L_{AB} = L_A + L_B + l_{AB}$ is the total number of edges in the merged community; $L_A$ and $L_B$ are the number of edges in communities $A$ and $B$ respectively and $l_{AB}$ is the number of direct edges between communities $A$ and $B$ \cite{Albert2016}. $k_{AB} = k_A + k_B$ is the total degree of nodes in the merged community \cite{Albert2016}. Inserting the formulas for $L_{AB}$ and $k_{AB}$ in Eq. (\ref{Q_AB}) gives
\begin{equation}
	\Delta Q_{AB} = \frac{l_{AB}}{L} - \frac{k_Ak_B}{2L^2}
\end{equation}

\chapter{Network models: Derivations}
\section{The Erd\H{o}s-R\'{e}nyi model}\label{ER}
\subsection{Average degree}\label{degree}
The expected mean degree is given by \cite{Hopcroft2006}
\begin{equation}\label{avDegr}
\begin{split}
	\left<k\right> &= \sum_{k=0}^{N-1} k\  p_k  \\
&= \sum_{k=0}^{N-1} k \binom{N-1}{k}p^k (1-p)^{N-1-k}
\end{split}
\end{equation}
In order to simplify this equation we can make use of the following formula \cite{Hopcroft2006}
\begin{equation} 
	(p+q)^n = \sum_{k=0}^n \binom{n}{k} p^k q^{n-k}
\end{equation}
Differentiating both sides of this equation gives us \cite{Hopcroft2006}
\begin{equation}
\begin{split}
	n(p+q)^{n-1} &= \sum_{k=0}^n \binom{n}{k} k p^{k-1} q^{n-k} \\
	&= \frac{1}{p} \sum_{k=0}^n \binom{n}{k} k p^{k} q^{n-k}
\end{split}
\end{equation}
Finally, by substituting $q = 1-p$, we get \cite{Hopcroft2006}
\begin{equation}
\begin{split}
	n (p+(1-p))^{n-1} &= \frac{1}{p} \sum_{k=0}^n \binom{n}{k} k p^{k} (1-p)^{n-k} \\
	np &= \sum_{k=0}^n \binom{n}{k} k p^{k} (1-p)^{n-k}
\end{split}
\end{equation}
where the right hand side is equal to Equation (\ref{avDegr}) with $n = N-1$ and we thus obtain $\left<k\right> = (N-1)p$.

\subsection{Poisson form of the degree distribution}\label{poiss}
We begin with the exact binomial distribution (Eq.(\ref{degDistRan}))
\begin{equation}\label{pk}
	p_k = \binom{N-1}{k}p^k (1-p)^{N-1-k}
\end{equation}
which characterizes a random graph. In the case $k \ll N$, we can simplify the binomial in the following way \cite{Albert2014}
\begin{equation}\label{bin}
	\binom{N-1}{k} = \frac{(N-1)(N-1-1)...(N-1-k+1)}{k!} \approx \frac{(N-1)^k}{k!}
\end{equation}
We also note the following equality \cite{Albert2014}
\begin{equation}
	\ln[(1-p)^{N-1-k}] = (N-1-k)\ln\bigg(1 - \frac{\left<k\right>}{N-1} \bigg)
\end{equation}
where we made use of the fact that $\left<k\right> = (N-1)p$. Using the series expansion \cite{Albert2014}
\begin{equation}
	\ln(1+x) = \sum_{n=1}^{\infty}\frac{(-1)^{n+1}}{n}x^n = x - \frac{x^2}{2} + \frac{x^3}{3} - ...  \qquad \forall \ |x| \leqslant 1
\end{equation}
we get \cite{Albert2014}
\begin{equation}
	\ln[(1-p)^{N-1-k}] \approx (N-1-k) \frac{\left<k\right>}{N-1} = - \left<k\right>\bigg(1 - \frac{\left<k\right>}{N-1} \bigg) \approx - \left<k\right>
\end{equation}
which is valid if $k \ll N$. We thus find \cite{Albert2014}
\begin{equation}\label{e}
	(1-p)^{N-1-k} = \mathrm{e}^{-\left<k\right>}
\end{equation}
Substituting Eq. (\ref{e}) and Eq. (\ref{bin}) in Eq. (\ref{pk}) and using $\left<k\right> = (N-1)p$, we finally obtain the Poisson form of the degree distribution \cite{Albert2014}
\begin{equation}
\begin{split}
	p_k &= \binom{N-1}{k}p^k (1-p)^{N-1-k} = \frac{(N-1)^k}{k!} p^k \mathrm{e}^{-\left<k\right>} \\
&= \frac{(N-1)^k}{k!} \bigg(\frac{\left<k\right>}{N-1} \bigg)^k \mathrm{e}^{-\left<k\right>}\\
&= \mathrm{e}^{-\left<k\right>}\frac{\left<k\right>^k}{k!}
\end{split}
\end{equation}

\subsection{Diameter}\label{ERdist}
The expected number of nodes at a distance $d$ from a starting node is \cite{Albert2014}
\begin{equation}\label{dist}
	N(d) = 1 + \left<k\right> + \left<k\right>^2 + ... + \left<k\right>^d = \frac{\left<k\right>^{d+1} - 1}{\left<k\right> - 1}
\end{equation}
$N(d)$ cannot exceed the number of nodes $N$ in the network. The maximum distance or diameter $d_{max}$ of the network can thus be found by setting \cite{Albert2014}
\begin{equation}
	N(d_{max}) \approx N
\end{equation}
If $\left<k\right> \gg 1$, we can neglect the $-1$ terms in Eq. (\ref{dist}), which gives \cite{Albert2014}
\begin{equation}
	N \approx \left<k\right>^{d_{max}}
\end{equation}
and thus the diameter of a random network becomes \cite{Albert2014}
\begin{equation}
	d_{max} \approx \frac{\ln{N}}{\ln{\left<k\right>}}
\end{equation} 

\section{The Watts-Strogatz model}\label{WS}
\subsection{The regular ring lattice}\label{ringclus}

\textbf{Clustering coefficient}\\
\newline
A triangle in the regular ring lattice requires two edge traversals in the same direction and one in the opposite direction \cite{Pele2015}. In the regular ring lattice every node has a fixed degree $K$, this means that each node is connected to $K/2$ neighbors on its left and $K/2$ neighbors on its right. It is then clear that the final, backwards step can span at most $K/2$ nodes \cite{Pele2015}; otherwise we would end up at a different node from which we started, which would definitely not form a triangle.\\
Hence, the number of triangles for a given node is given by choosing the two forward target nodes from the $K/2$ possibilities \cite{Pele2015}
\begin{equation}\label{triangle}
	\binom{\frac{K}{2}}{2} = \frac{1}{4} K \bigg(\frac{K}{2} - 1 \bigg)
\end{equation}
The number of connected triples per node is given by choosing two nodes out of the $K$ neighbors \cite{Pele2015}
\begin{equation}\label{triple}
	\binom{K}{2} = \frac{1}{2} K (K-1)
\end{equation}
Since every node in the regular ring lattice is identical, we can easily find the total number of triangles and connected triples in the network by multiplying Eq. (\ref{triangle}) and Eq. (\ref{triple}) with the number of nodes $N$. We then obtain the final result for the clustering coefficient in the regular ring lattice \cite{Pele2015}
\begin{equation}
	\bar{C} = \frac{3\cdot N \frac{1}{4} K \bigg(\frac{K}{2} - 1 \bigg)}{N \frac{1}{2} K (K-1)} = \frac{3(K-2)}{4(K-1)}
\end{equation}
\newline
\textbf{Average distance}\\
\newline
The general formula for the average distance is given by Eq. (\ref{avdist})
\begin{equation}
	l = \frac{1}{N(N-1)} \sum_{i \neq j} d_{ij}
\end{equation}
where the sum runs over the shortest path between every pair of nodes. Assume we have a regular ring lattice with $N$ nodes and each node has $K$ neighbors. Now we can calculate the distance between node $i$ and every other node in the ring lattice
\begin{itemize}
	\item There are $K$ nodes adjacent to node $i$, so there are $K$ nodes with a distance $d_{ij} = 1$
	\item There are $K$ nodes that are neighbors of the neighbors of node $i$, so there are $K$ nodes with a distance $d_{ij} = 2$
	\item ...
	\item There are $K$ nodes that have a distance $d_{ij} = \frac{N}{K}$ between them and node $i$; its easy to see that these are the nodes that are the furthest away from node $i$ 
\end{itemize}  
So the average distance for node $i$ becomes \cite{chap9}
\begin{equation}
	l_i = \frac{1}{N-1} K \bigg(1 + 2 + 3 + ... + \frac{N}{K} \bigg) \approx \frac{K}{N} \bigg(1 + 2 + 3 + ... + \frac{N}{K} \bigg)
\end{equation}
where the last approximation holds for $N \gg 1$. Since every node in the regular ring lattice is identical we can easily find the average distance of the network \cite{chap9}
\begin{equation}
	l = \frac{1}{N} \sum_i l_i = \frac{1}{N} N l_i \approx \frac{K}{N} \bigg(1 + 2 + 3 + ... + \frac{N}{K} \bigg)
\end{equation}
Using \cite{chap9}
\begin{equation}
	1 + 2+ 3 +...+ x = \sum_{i = 1}^x i = \frac{x(x+1)}{2} \approx \frac{x^2}{2}
\end{equation}
where the last approximation again holds for $x \gg 1$; we finally obtain \cite{chap9}
\begin{equation}
	l \approx \frac{K}{N} \frac{\frac{N^2}{K^2}}{2} = \frac{N}{2K}
\end{equation}

\newpage
\backmatter
% bibliography
\bibliographystyle{abbrv} % can change this style
\bibliography{references}
% to run this go to correct location in terminal --> type: pdflatex name, (file name.tex) --> type: bibtex name --> type: pdflatex name --> type: pdflatex name 
\end{document}